<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RSA — Dropshipping (INR) </title>
  <style>
    :root{--bg:#070707;--card:#0f0f0f;--muted:#cfc6bd;--accent:#d4af37;--ff: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;}
    *{box-sizing:border-box}
    body{margin:0;font-family:var(--ff);background:linear-gradient(180deg,#050505,#0b0b0b);color:#fff}
    .wrap{max-width:1200px;margin:28px auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:center}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .mark{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#f7e6b0);display:flex;align-items:center;justify-content:center;color:#060606;font-weight:800}
    nav a{color:var(--muted);margin-left:14px;text-decoration:none}
    h1,h2{margin:0}
    .hero{display:flex;gap:20px;margin-top:18px;align-items:center}
    .hero .left{flex:1}
    .btn{background:var(--accent);color:#060606;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;margin-top:20px}
    .card{background:linear-gradient(180deg,var(--card),rgba(255,255,255,0.01));padding:12px;border-radius:12px}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
    .price{font-weight:800;color:var(--accent)}
    .muted{color:var(--muted)}
    .cart-btn{position:fixed;right:18px;bottom:18px;background:transparent;border:2px solid var(--accent);padding:12px;border-radius:12px;color:var(--accent);cursor:pointer}
    .cart-panel{position:fixed;right:18px;bottom:78px;width:360px;max-height:70vh;overflow:auto;background:#0b0b0b;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center}
    .modal{width:520px;background:linear-gradient(180deg,#0f0f0f,#090909);padding:18px;border-radius:12px}
    input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff}
    footer{margin-top:28px;text-align:center;color:var(--muted)}
    .admin{margin-top:18px;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02)}
    @media (max-width:720px){.hero{flex-direction:column}.modal{width:94%}.cart-panel{width:92%}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <div class="mark">RSA</div>
        <div>
          <h1>RSA — Store (?)</h1>
          <div class="muted">Delivery: Auroville only · Payments: GPay (manual UPI confirmation)</div>
        </div>
      </div>
      <nav>
        <a href="#home">Home</a>
        <a href="#shop">Shop</a>
        <a href="#contact">Contact</a>
      </nav>
    </header>

    <section class="hero" id="home">
      <div class="left">
        <h2>Everything you need — priced in Indian Rupees (?)</h2>
        <p class="muted">100 items preloaded. You can add/edit items from the admin panel below. Orders are stored locally and can be exported as CSV. For real GPay payments, replace the placeholder UPI ID with your real UPI ID in settings.</p>
        <div style="margin-top:12px"><button class="btn" id="browse">Browse Shop</button></div>
      </div>
      <div style="width:340px">
        <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=900&auto=format&fit=crop&s=6fb7f6f3ab1c1ec6d8dd4d6d1f6c6c75" style="width:100%;border-radius:12px;object-fit:cover"/>
      </div>
    </section>

    <section id="shop">
      <h2 style="margin-top:18px">Shop</h2>
      <div class="grid" id="productsGrid"></div>
    </section>

    <section id="contact">
      <h2 style="margin-top:18px">Contact & Settings</h2>
      <div class="muted">Owner contact (replace): <strong id="ownerContact">your-email@example.com</strong></div>
      <div style="margin-top:8px">GPay UPI ID (for customers to pay) — <em>replace with your UPI ID</em>:</div>
      <input id="upiId" placeholder="your-upi@bank" />
      <div style="margin-top:8px"><button class="btn" id="saveSettings">Save Settings</button></div>
    </section>

    <div class="admin">
      <strong>Admin — Add product</strong>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px">
        <input id="pTitle" placeholder="Title" />
        <input id="pPrice" placeholder="Price (?)" />
        <input id="pImg" placeholder="Image URL (optional)" />
        <input id="pCat" placeholder="Category (optional)" />
        <textarea id="pDesc" placeholder="Short description" style="grid-column:1 / -1"></textarea>
      </div>
      <div style="text-align:right;margin-top:8px"><button class="btn" id="addProd">Add Product</button></div>
      <div style="margin-top:8px" class="muted">Tip: Use images from unsplash or picsum (default images are used if none provided).</div>
      <div style="margin-top:12px"><button class="btn ghost" id="exportOrders">Export Orders (CSV)</button></div>
    </div>

    <footer>© RSA — Auroville local delivery only</footer>
  </div>

  <button id="cartBtn" class="cart-btn">Cart (<span id="cartCount">0</span>)</button>
  <div id="cartPanel" class="cart-panel" style="display:none"></div>
  <div id="modalRoot" style="display:none"></div>

  <script>
    // Local keys
    const LS_PRODUCTS = 'rsa_inr_products_v1';
    const LS_ORDERS = 'rsa_inr_orders_v1';
    const LS_SETTINGS = 'rsa_inr_settings_v1';

    // generate 100 demo products if none
    function genDemoProducts(){
      const arr = [];
      for(let i=1;i<=100;i++){
        const price = Math.floor(Math.random()*4800)+199; // ?199 - ?4998
        arr.push({id:'p'+i,title:`Product ${i}`,price:price,img:`https://picsum.photos/seed/product${i}/600/400`,desc:`Quality product #${i}`,category: i%5===0 ? 'Gadgets' : i%3===0 ? 'Home' : 'Accessories'});
      }
      return arr;
    }

    function saveProducts(arr){localStorage.setItem(LS_PRODUCTS, JSON.stringify(arr))}
    function loadProducts(){const s=localStorage.getItem(LS_PRODUCTS); if(!s){const demo=genDemoProducts(); saveProducts(demo); return demo;} try{return JSON.parse(s)}catch(e){const demo=genDemoProducts(); saveProducts(demo); return demo}}
    function saveOrders(arr){localStorage.setItem(LS_ORDERS, JSON.stringify(arr))}
    function loadOrders(){const s=localStorage.getItem(LS_ORDERS); if(!s) return []; try{return JSON.parse(s)}catch(e){return []}}
    function saveSettings(o){localStorage.setItem(LS_SETTINGS, JSON.stringify(o))}
    function loadSettings(){const s=localStorage.getItem(LS_SETTINGS); if(!s) return {upi:'your-upi@bank',owner:'your-email@example.com'}; try{return JSON.parse(s)}catch(e){return {upi:'your-upi@bank',owner:'your-email@example.com'}}}

    // render
    function renderProducts(){const grid=document.getElementById('productsGrid'); grid.innerHTML=''; const products=loadProducts(); products.forEach(p=>{
      const el=document.createElement('div'); el.className='card'; el.innerHTML = `
        <img src="${p.img}" alt="${escapeHtml(p.title)}" />
        <h3>${escapeHtml(p.title)}</h3>
        <div class="muted">${escapeHtml(p.category||'')}</div>
        <div class="muted" style="margin:6px 0">${escapeHtml(p.desc||'')}</div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="price">?${Number(p.price).toFixed(0)}</div>
          <div><button class="btn" onclick="openCheckout('${p.id}')">Order Now</button> <button class="btn ghost" onclick="addToCart('${p.id}')">Add</button></div>
        </div>`;
      grid.appendChild(el);
    })}

    function escapeHtml(s){ if(!s) return ''; return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;') }

    // admin add
    document.getElementById('addProd').addEventListener('click', ()=>{
      const title=document.getElementById('pTitle').value.trim(); const price = Number(document.getElementById('pPrice').value);
      const img=document.getElementById('pImg').value.trim() || ('https://picsum.photos/600/400?'+Math.random()); const desc=document.getElementById('pDesc').value.trim(); const cat=document.getElementById('pCat').value.trim();
      if(!title || !price || isNaN(price)){alert('Please provide valid title and price'); return}
      const products=loadProducts(); const id = 'p_'+Math.random().toString(36).slice(2,9);
      products.unshift({id,title,price, img, desc, category:cat}); saveProducts(products); renderProducts(); document.getElementById('pTitle').value='';document.getElementById('pPrice').value='';document.getElementById('pImg').value='';document.getElementById('pDesc').value='';document.getElementById('pCat').value=''; alert('Product added locally.')
    })

    // cart
    let cart = JSON.parse(localStorage.getItem('rsa_inr_cart')||'[]');
    function addToCart(id){const products=loadProducts(); const p=products.find(x=>x.id===id); if(!p) return; const ex=cart.find(x=>x.id===id); if(ex){ex.qty++} else cart.push({id:p.id,title:p.title,price:p.price,img:p.img,qty:1}); localStorage.setItem('rsa_inr_cart', JSON.stringify(cart)); updateCartCount(); renderCartPanel();}
    function updateCartCount(){document.getElementById('cartCount').innerText = cart.reduce((s,i)=>s+i.qty,0)}
    document.getElementById('cartBtn').addEventListener('click', ()=>{const panel=document.getElementById('cartPanel'); panel.style.display = panel.style.display==='none'? 'block' : 'none'; renderCartPanel();})

    function renderCartPanel(){const panel=document.getElementById('cartPanel'); if(cart.length===0){panel.innerHTML='<div class="muted">Cart empty.</div>'; updateCartCount(); return} let total=0; let html=''; cart.forEach(it=>{ total += it.price*it.qty; html += `<div style="display:flex;gap:10px;align-items:center;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.03)"><img src="${it.img}" style="width:64px;height:48px;object-fit:cover;border-radius:6px"/><div style="flex:1"><div style="font-weight:700">${escapeHtml(it.title)}</div><div class="muted">?${it.price} × ${it.qty}</div></div><div><button class="btn ghost" onclick="changeQty(\'${it.id}\',-1)">-</button> <button class="btn ghost" onclick="changeQty(\'${it.id}\',1)">+</button></div></div>`}); html += `<div style="padding-top:10px;font-weight:800">Total: ?${total.toFixed(0)}</div><div style="text-align:right;margin-top:10px"><button class="btn" onclick="openCartCheckout()">Checkout</button></div>`; panel.innerHTML = html; updateCartCount(); }
    function changeQty(id,delta){const it=cart.find(x=>x.id===id); if(!it) return; it.qty += delta; if(it.qty<=0) cart = cart.filter(x=>x.id!==id); localStorage.setItem('rsa_inr_cart', JSON.stringify(cart)); renderCartPanel(); updateCartCount();}

    // checkout
    function openCheckout(prodId){const products=loadProducts(); const p=products.find(x=>x.id===prodId); if(!p) return; openModal(checkoutHtmlSingle(p));}
    function openCartCheckout(){ if(cart.length===0){alert('Cart empty');return} openModal(checkoutHtmlCart());}

    function checkoutHtmlSingle(p){ return `
      <div class="modal"><h3>Order — ${escapeHtml(p.title)}</h3>
        <div class="muted">Price: ?${Number(p.price).toFixed(0)}</div>
        <div style="display:flex;gap:12px;margin-top:12px"><img src="${p.img}" style="width:120px;height:90px;object-fit:cover;border-radius:8px"/><div><div class="muted">${escapeHtml(p.desc||'')}</div></div></div>
        <div style="margin-top:12px">
          <label class="muted">Name</label><input id="cName" type="text" />
          <label class="muted">Phone</label><input id="cPhone" type="text" />
          <label class="muted">Shipping address (must include Auroville)</label><textarea id="cAddress" rows="3"></textarea>
          <div style="margin-top:8px"><strong>Pay with GPay (UPI)</strong></div>
          <div class="muted" style="font-size:13px;margin-top:4px">We will show a UPI ID / QR for you to pay manually. Replace the UPI ID in Contact settings with your real UPI ID.</div>
          <div style="text-align:right;margin-top:10px"><button class="btn" onclick="placeOrderSingle('${p.id}')">Place Order & Pay</button> <button class="btn ghost" onclick="closeModal()">Cancel</button></div>
        </div>
      </div>` }

    function checkoutHtmlCart(){ return `
      <div class="modal"><h3>Cart Checkout</h3>
        <div class="muted">Items: ${cart.length} • Total: ?${cart.reduce((s,i)=>s+i.price*i.qty,0).toFixed(0)}</div>
        <div style="margin-top:12px">
          <label class="muted">Name</label><input id="cName2" type="text" />
          <label class="muted">Phone</label><input id="cPhone2" type="text" />
          <label class="muted">Shipping address (must include Auroville)</label><textarea id="cAddress2" rows="3"></textarea>
          <div style="margin-top:8px"><strong>Pay with GPay (UPI)</strong></div>
          <div class="muted" style="font-size:13px;margin-top:4px">After clicking Place Order, you'll be shown the UPI ID and asked to paste your transaction ID here to confirm payment.</div>
          <div style="text-align:right;margin-top:10px"><button class="btn" onclick="placeOrderCart()">Place Order & Pay</button> <button class="btn ghost" onclick="closeModal()">Cancel</button></div>
        </div>
      </div>` }

    function openModal(inner){const root=document.getElementById('modalRoot'); root.style.display='block'; root.innerHTML = `<div class="modal-backdrop">${inner}</div>`}
    function closeModal(){const root=document.getElementById('modalRoot'); root.style.display='none'; root.innerHTML=''}

    // place orders with Auroville check and UPI simulation
    function placeOrderSingle(productId){const name=document.getElementById('cName').value.trim(); const phone=document.getElementById('cPhone').value.trim(); const addr=document.getElementById('cAddress').value.trim(); if(!name||!phone||!addr){alert('Fill name, phone and address');return} if(!addr.toLowerCase().includes('auroville')){alert('Delivery is Auroville only. Please include "Auroville" in the address.');return}
      const products=loadProducts(); const p=products.find(x=>x.id===productId);
      // create order
      const order={id:'o_'+Math.random().toString(36).slice(2,9),items:[{id:p.id,title:p.title,price:p.price,qty:1}],customer:{name,phone,address:addr},total:p.price,date:new Date().toISOString(),paid:false};
      // save order first
      const orders=loadOrders(); orders.unshift(order); saveOrders(orders);
      // show payment instructions
      closeModal(); promptGPayAndConfirm(order.id);
    }

    function placeOrderCart(){const name=document.getElementById('cName2').value.trim(); const phone=document.getElementById('cPhone2').value.trim(); const addr=document.getElementById('cAddress2').value.trim(); if(!name||!phone||!addr){alert('Fill name, phone and address');return} if(!addr.toLowerCase().includes('auroville')){alert('Delivery is Auroville only. Please include "Auroville" in the address.');return}
      const orders=loadOrders(); const order={id:'o_'+Math.random().toString(36).slice(2,9),items:cart.map(i=>({id:i.id,title:i.title,price:i.price,qty:i.qty})),customer:{name,phone,address:addr},total:cart.reduce((s,i)=>s+i.price*i.qty,0),date:new Date().toISOString(),paid:false}; orders.unshift(order); saveOrders(orders); localStorage.removeItem('rsa_inr_cart'); cart=[]; renderCartPanel(); closeModal(); promptGPayAndConfirm(order.id);
    }

    // prompt payment via GPay (manual)
    function promptGPayAndConfirm(orderId){const settings = loadSettings(); const upi = settings.upi || 'your-upi@bank'; const order = loadOrders().find(o=>o.id===orderId); if(!order) return; const payHtml = `
      <div class="modal"><h3>Pay for Order ${order.id}</h3>
      <div class="muted">Total: ?${order.total.toFixed(0)}</div>
      <div style="margin-top:8px"><strong>Pay using GPay / UPI</strong></div>
      <div class="muted" style="margin-top:8px">Send the amount to this UPI ID: <strong id=showUpi>${escapeHtml(upi)}</strong></div>
      <div style="margin-top:8px">Or scan this QR from your phone (replace UPI ID in settings to generate your real QR externally)</div>
      <div style="margin-top:8px"><label class="muted">After paying, paste the transaction / UPI reference ID here to confirm:</label><input id="txnId" placeholder="UPI txn id"/></div>
      <div style="text-align:right;margin-top:10px"><button class="btn" onclick="confirmPayment('${order.id}')">Confirm Payment</button> <button class="btn ghost" onclick="closeModal()">Cancel</button></div>
      </div>`; openModal(payHtml);} 

    function confirmPayment(orderId){const txn = document.getElementById('txnId').value.trim(); if(!txn){alert('Paste your UPI transaction ID');return} const orders=loadOrders(); const ord = orders.find(o=>o.id===orderId); if(!ord) return; ord.paid=true; ord.txn=txn; saveOrders(orders); closeModal(); alert('Payment confirmed and order marked as PAID. Order ID: '+orderId); console.log('Order confirmed:', ord);}

    // export orders to CSV
    document.getElementById('exportOrders').addEventListener('click', ()=>{
      const orders = loadOrders(); if(!orders.length){alert('No orders to export');return}
      let csv = 'order_id,date,customer_name,phone,address,total,paid,txn,items
';
      orders.forEach(o=>{ const items = o.items.map(i=>i.title+' x'+i.qty).join('|'); csv += `${o.id},${o.date},"${o.customer.name}","${o.customer.phone}","${o.customer.address}",${o.total},${o.paid? 'YES':'NO'},${o.txn||''},"${items}"
`; });
      const blob = new Blob([csv], {type:'text/csv'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='rsa_orders.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    })

    // settings save
    document.getElementById('saveSettings').addEventListener('click', ()=>{ const upi = document.getElementById('upiId').value.trim() || 'your-upi@bank'; const owner = document.getElementById('ownerContact').innerText || 'your-email@example.com'; saveSettings({upi,owner}); alert('Settings saved locally. Replace with your real UPI ID for real payments.'); })

    // util
    document.getElementById('browse').addEventListener('click', ()=>{document.getElementById('shop').scrollIntoView({behavior:'smooth'})})

    // initial
    document.getElementById('upiId').value = loadSettings().upi || 'your-upi@bank'; document.getElementById('ownerContact').innerText = loadSettings().owner || 'your-email@example.com'; renderProducts(); cart = JSON.parse(localStorage.getItem('rsa_inr_cart')||'[]'); updateCartCount();

    // convenience: view orders by pressing O then R
    document.addEventListener('keydown', (e)=>{ if((e.key==='r' || e.key==='R') && (window.lastKey==='o' || window.lastKey==='O')){console.log('RSA Orders:', loadOrders()); alert('Orders dumped to console');} window.lastKey = e.key})

  </script>
</body>
</html>
